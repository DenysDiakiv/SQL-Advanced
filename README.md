# SQL-Advanced

# üìä –ê–Ω–∞–ª—ñ–∑ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –∞–∫–∞—É–Ω—Ç—ñ–≤ —Ç–∞ Email-–º–∞—Ä–∫–µ—Ç–∏–Ω–≥—É (DA Metrics)

–¶–µ–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π –º—ñ—Å—Ç–∏—Ç—å —Ñ—ñ–Ω–∞–ª—å–Ω–∏–π SQL-—Å–∫—Ä–∏–ø—Ç (`Final Query.sql`), —Ä–æ–∑—Ä–æ–±–ª–µ–Ω–∏–π –¥–ª—è **–∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ email-—Ä–æ–∑—Å–∏–ª–æ–∫ —Ç–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤**, –∑–≥—Ä—É–ø–æ–≤–∞–Ω–∏—Ö –∑–∞ –≥–µ–æ–≥—Ä–∞—Ñ—ñ—î—é —Ç–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –∞–∫–∞—É–Ω—Ç—É.

## üéØ –ú–µ—Ç–∞ –ø—Ä–æ—î–∫—Ç—É

–ì–æ–ª–æ–≤–Ω–∞ –º–µ—Ç–∞ —Å–∫—Ä–∏–ø—Ç–∞ ‚Äî –æ–±'—î–¥–Ω–∞—Ç–∏ –º–µ—Ç—Ä–∏–∫–∏ –∞–∫–∞—É–Ω—Ç—ñ–≤ —Ç–∞ email-–ø–æ–¥—ñ–π (–≤—ñ–¥–ø—Ä–∞–≤–∫–∞, –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è, –≤—ñ–∑–∏—Ç) –¥–ª—è **–≤–∏—è–≤–ª–µ–Ω–Ω—è –≥–µ–æ–≥—Ä–∞—Ñ—ñ—á–Ω–∏—Ö –ª—ñ–¥–µ—Ä—ñ–≤**.

### –ö–ª—é—á–æ–≤–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–°–∫—Ä–∏–ø—Ç –≥–µ–Ω–µ—Ä—É—î —Ñ—ñ–Ω–∞–ª—å–Ω—É —Ç–∞–±–ª–∏—Ü—é –∑ –¥–µ—Ç–∞–ª—ñ–∑–æ–≤–∞–Ω–∏–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏, –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–¥—ñ–ª—è—é—á–∏ **–¢–û–ü-10 –∫—Ä–∞—ó–Ω** –∑–∞ –¥–≤–æ–º–∞ –∫—Ä–∏—Ç–µ—Ä—ñ—è–º–∏:
1.  –ó–∞–≥–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–∏—Ö –∞–∫–∞—É–Ω—Ç—ñ–≤.
2.  –ó–∞–≥–∞–ª—å–Ω–∏–π –æ–±—Å—è–≥ –Ω–∞–¥—ñ—Å–ª–∞–Ω–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å.

---

## üèóÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–ø–∏—Ç—É

–ö–æ–¥ —É —Ñ–∞–π–ª—ñ `Final Query.sql` –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î **Common Table Expressions (CTE)** –¥–ª—è –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ–≥–æ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è –º–µ—Ç—Ä–∏–∫:
* –û–±—á–∏—Å–ª–µ–Ω–Ω—è –∞–∫–∞—É–Ω—Ç—ñ–≤ (–∑ –¥–∞—Ç–∏ —Å–µ—Å—ñ—ó).
* –û–±'—î–¥–Ω–∞–Ω–Ω—è —Ç–∞ –∞–≥—Ä–µ–≥–∞—Ü—ñ—è email-–ø–æ–¥—ñ–π.
* –û–±'—î–¥–Ω–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö —á–µ—Ä–µ–∑ `FULL OUTER JOIN` —Ç–∞ —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –∑–∞–≥–∞–ª—å–Ω–∏—Ö –ø–æ–∫–∞–∑–Ω–∏–∫—ñ–≤ –ø–æ –∫—Ä–∞—ó–Ω—ñ.
* –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Ä–µ–π—Ç–∏–Ω–≥—É (`DENSE_RANK()`) –¥–ª—è —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó –¢–û–ü-10.

---

## üõ†Ô∏è –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

–°–∫—Ä–∏–ø—Ç –æ–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω–æ –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –≤ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞—Ö, —â–æ –ø—ñ–¥—Ç—Ä–∏–º—É—é—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π SQL (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, Google BigQuery). **–í–∏–∫–æ–Ω–∞–π—Ç–µ —Ñ–∞–π–ª `Final Query.sql`**, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ —Ñ—ñ–Ω–∞–ª—å–Ω–∏–π –Ω–∞–±—ñ—Ä –¥–∞–Ω–∏—Ö, –≥–æ—Ç–æ–≤–∏–π –¥–æ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—ó.
